<!-- Create paragraph to hold information for the system name, location, and SOP number -->
<p>Audit Trail Review <input type="text" id="sys_name" placeholder="System Name"> at
    <input type="text" id="location" placeholder="Location"> per
    <input type="text" id="sop" placeholder="SOP Number">
</p>
<!-- Create paragraph to confirm/deny whether there has been any unauthorized activity -->
<p id="unauth">Unauthorized activity?<span id="test0">
        <label>No</label><input type="radio" name="yn0">
        <label>Yes</label><input type="radio" name="yn0"></span>
</p>

<p id="clock">Clock Correct?<span id="test1">
        <label>No</label><input type="radio" name="yn1">
        <label>Yes</label><input type="radio" name="yn1"></span>
</p>

<p id="use"><input type="text" id="quantity" name="quantity" placeholder="Ex: 5"> user(s) deactivated:
    <input type="text" name="users" id="users" placeholder="John Doe, Mary Sue, Bob Ross">
</p>

<p id="intent">Backups working as intended?<span id="test2">
        <label>No</label><input type="radio" name="yn2">
        <label>Yes</label><input type="radio" name="yn2"></span>
</p>

<p id="img"><input type="file" name="back_image" id="image" accept="image/*"></p>


<script>
    document.addEventListener("DOMContentLoaded", function () {
        // Convert text fields to text
        var textFields = document.querySelectorAll("input[type='text']");
        textFields.forEach(function (field) {
            field.addEventListener("blur", function () {
                var text = this.value;
                var textNode = document.createTextNode(text);
                this.parentNode.replaceChild(textNode, this);
            });
        });

        // Convert radio buttons to text
        var radioButtons = document.querySelectorAll("input[type='radio']");
        let i = 0;
        radioButtons.forEach(function (radio) {
            radio.addEventListener("change", function () {
                var label = this.previousElementSibling;
                if (this.checked) {
                    var value = label.textContent;
                    var parent = label.parentNode;
                    var paragraph = parent.parentNode;
                    parent.remove();
                    if (paragraph.textContent.includes("Unauthorized") && value === "Yes") {
                        // Create the textarea element
                        var textarea = document.createElement("textarea");
                        textarea.rows = 4;
                        textarea.cols = 30;
                        textarea.placeholder = "Please describe what unauthorized activity was noticed";

                        // Append the textarea below the paragraph
                        paragraph.parentNode.insertBefore(textarea, paragraph.nextSibling);

                        // Convert textarea to text
                        var textareas = document.querySelectorAll("textarea");
                        textareas.forEach(function (textarea) {
                            textarea.addEventListener("blur", function () {
                                var text = "\t" + this.value;
                                var textNode = document.createTextNode(text);
                                var paragraph = document.createElement("p");
                                paragraph.appendChild(textNode);
                                this.parentNode.replaceChild(paragraph, this);
                            });
                        });
                    }
                    paragraph.textContent = paragraph.textContent + value;

                }
            });
        });

        // Convert file upload to image
        var fileInput = document.getElementById("image");
        fileInput.addEventListener("change", function () {
            var file = this.files[0];
            var reader = new FileReader();
            reader.onload = function (e) {
                var image = document.createElement("img");
                image.src = e.target.result;
                fileInput.parentNode.replaceChild(image, fileInput);
            };
            reader.readAsDataURL(file);
        });
    });
</script>